


## Comparisons IC

Let's make a comparison of various IC metrics, using the GO BP ontology.

```r
lt = lapply(all_ic_methods(), function(method) {
    cat("=====", method, "=====\n")
    term_IC(dag, method)
})
names(lt) = all_ic_methods()

df = as.data.frame(lt)
pairs(df, pch = ".", col = dag_depth(dag), gap = 0)
```

And the heatmap of the correlations of IC metrics. 

```{r, fig.width = 6, fig.height = 6}
cor = cor(df, method = "spearman", use = "pairwise.complete.obs")
library(ComplexHeatmap)
Heatmap(cor, name = "correlation", column_title = "Spearman correlation")
```



## Comparisons term sim

Let's make a comparison of various similarity methods, using the GO BP ontology.

```r
set.seed(123)
ic = term_IC(dag, method = "IC_annotation")
ic = ic[!is.na(ic)]
go_id = sample(names(ic), 100)

lt = lapply(all_term_sim_methods(), function(method) {
    cat("=====", method, "=====\n")
    m = term_sim(dag, go_id, method)
    m[lower.tri(m)]
})
names(lt) = all_term_sim_methods()
df = as.data.frame(lt)

LCA_depth = LCA_depth(dag, go_id)
LCA_depth = LCA_depth[lower.tri(LCA_depth)]

pairs(df[, 1:29], pch = ".", gap = 0, col = LCA_depth+1)
```


And the heatmap of the correlations of IC metrics. 

```{r, fig.width = 8, fig.height = 8}
cor = cor(df[, 1:29], method = "spearman", use = "pairwise.complete.obs")
library(ComplexHeatmap)
Heatmap(cor, name = "correlation", column_title = "Spearman correlation")
```

## Visualize DAG

```{r}
dag_circular_viz(dag, reorder_level = 2)
```

## Session Info

```{r}
sessionInfo()
```
