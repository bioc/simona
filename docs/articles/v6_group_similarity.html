<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Similarity between two groups of terms • simona</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Similarity between two groups of terms">
<meta property="og:description" content="simona">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">simona</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.99.7</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/v1_dag.html">ontology_DAG: a class for ontology data</a>
    </li>
    <li>
      <a href="../articles/v2_GO.html">Gene Ontology</a>
    </li>
    <li>
      <a href="../articles/v3_import.html">Import ontology files</a>
    </li>
    <li>
      <a href="../articles/v4_information_content.html">Information content</a>
    </li>
    <li>
      <a href="../articles/v5_term_similarity.html">Term similarity</a>
    </li>
    <li>
      <a href="../articles/v6_group_similarity.html">Similarity between two groups of terms</a>
    </li>
    <li>
      <a href="../articles/v7_dag_visualization.html">Visualize DAGs</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/jokergoo/simona/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Similarity between two groups of terms</h1>
                        <h4 data-toc-skip class="author">Zuguang Gu ( <a href="mailto:z.gu@dkfz.de" class="email">z.gu@dkfz.de</a> )</h4>
            
            <h4 data-toc-skip class="date">2023-10-05</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/jokergoo/simona/blob/HEAD/vignettes/v6_group_similarity.Rmd" class="external-link"><code>vignettes/v6_group_similarity.Rmd</code></a></small>
      <div class="hidden name"><code>v6_group_similarity.Rmd</code></div>

    </div>

    
    
<p>The methods of group similarity implemented in <strong>simona</strong> are mainly from the <a href="https://academic.oup.com/bib/article/18/5/886/2562801#supplementary-data" class="external-link">supplementary file</a> of the paper <a href="https://doi.org/10.1093/bib/bbw067" class="external-link">“Mazandu et al., Gene Ontology semantic similarity tools: survey on features and challenges for biological knowledge discovery. Briefings in Bioinformatics 2017”</a>. Original denotations have been slightly modified to make them more consistent. Also more explanations have been added in this vignette.</p>
<p>There are two groups of terms denoted as <span class="math inline">\(T_p\)</span> and <span class="math inline">\(T_q\)</span> represented as two sets:</p>
<p><span class="math display">\[ T_p = \{ a_1, a_2, ...\} \\
   T_q = \{ b_1, b_2, ... \} \]</span></p>
<p>where <span class="math inline">\(a_i\)</span> is a term in set <span class="math inline">\(T_p\)</span> and <span class="math inline">\(b_j\)</span> is a term in set <span class="math inline">\(T_q\)</span>.</p>
<p>The wrapper function <code><a href="../reference/group_sim.html">group_sim()</a></code> calculates semantic similarities between two groups of terms with a specific method. Note the method name can be partially matched.</p>
<pre class="r">
group_sim(dag, group1, group2, method = ..., control = list(...))
</pre>
<p>Some of the group similarity methods have no assumption of which similarity measure between single terms to use. If there are annotation already provided in the DAG object, by default <em>Sim_Lin_1998</em> is used, or else <em>Sim_WP_1994</em> is used. The term similarity method can be set via the <code>term_sim_method</code> parameter in <code>control</code>. Additionally parameters for a specific <code>term_sim_method</code> can also be set in <code>control</code>.</p>
<pre class="r">
group_sim(dag, group1, group2, method = ..., 
    control = list(term_sim_method = ...))
</pre>
<p>All supported group similarity methods are:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jokergoo/simona" class="external-link">simona</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/all_methods.html">all_group_sim_methods</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  [1] "GroupSim_pairwise_avg"            "GroupSim_pairwise_max"           </span></span>
<span><span class="co">##  [3] "GroupSim_pairwise_BMA"            "GroupSim_pairwise_BMM"           </span></span>
<span><span class="co">##  [5] "GroupSim_pairwise_ABM"            "GroupSim_pairwise_HDF"           </span></span>
<span><span class="co">##  [7] "GroupSim_pairwise_MHDF"           "GroupSim_pairwise_VHDF"          </span></span>
<span><span class="co">##  [9] "GroupSim_pairwise_Froehlich_2007" "GroupSim_pairwise_Joeng_2014"    </span></span>
<span><span class="co">## [11] "GroupSim_SimALN"                  "GroupSim_SimGIC"                 </span></span>
<span><span class="co">## [13] "GroupSim_SimDIC"                  "GroupSim_SimUIC"                 </span></span>
<span><span class="co">## [15] "GroupSim_SimUI"                   "GroupSim_SimDB"                  </span></span>
<span><span class="co">## [17] "GroupSim_SimUB"                   "GroupSim_SimNTO"                 </span></span>
<span><span class="co">## [19] "GroupSim_SimCOU"                  "GroupSim_SimCOT"                 </span></span>
<span><span class="co">## [21] "GroupSim_SimLP"                   "GroupSim_Ye_2005"                </span></span>
<span><span class="co">## [23] "GroupSim_SimCHO"                  "GroupSim_SimALD"                 </span></span>
<span><span class="co">## [25] "GroupSim_Jaccard"                 "GroupSim_Dice"                   </span></span>
<span><span class="co">## [27] "GroupSim_Overlap"                 "GroupSim_Kappa"</span></span></code></pre>
<div class="section level2">
<h2 id="pairwise-term-similarity-based-methods">Pairwise term similarity-based methods<a class="anchor" aria-label="anchor" href="#pairwise-term-similarity-based-methods"></a>
</h2>
<div class="section level3">
<h3 id="groupsim_pairwise_avg">GroupSim_pairwise_avg<a class="anchor" aria-label="anchor" href="#groupsim_pairwise_avg"></a>
</h3>
<p>Denote <span class="math inline">\(S(a, b)\)</span> as the semantic similarity between term <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> where <span class="math inline">\(a\)</span> is from group <span class="math inline">\(p\)</span> and <span class="math inline">\(b\)</span> is from group <span class="math inline">\(q\)</span>, The similarity between group <span class="math inline">\(p\)</span> and group <span class="math inline">\(q\)</span> is the average similarity of every pair of individual terms in the two groups:</p>
<p><span class="math display">\[ \mathrm{GroupSim}(p, q) = \frac{1}{|T_p|*|T_q|} \sum_{a \in T_p, b \in T_q}S(a, b) \]</span></p>
<p>The term semantic similarity method and the IC method can be set via <code>control</code> argument, for example:</p>
<pre class="r">
group_sim(dag, group1, group2, method = "GroupSim_pairwise_avg"
    control = list(term_sim_method = "Sim_Lin_1998", IC_method = "IC_annotation")`.
</pre>
<p>Other parameters for the <code>term_sim_method</code> can also be set in the <code>control</code> list.</p>
<p>Paper link: <a href="https://doi.org/10.1093/bioinformatics/btg153" class="external-link uri">https://doi.org/10.1093/bioinformatics/btg153</a>.</p>
</div>
<div class="section level3">
<h3 id="groupsim_pairwise_max">GroupSim_pairwise_max<a class="anchor" aria-label="anchor" href="#groupsim_pairwise_max"></a>
</h3>
<p>The similarity is defined as the maximal <span class="math inline">\(S(a, b)\)</span> among all pairs of terms in group <span class="math inline">\(p\)</span> and <span class="math inline">\(q\)</span>:</p>
<p><span class="math display">\[ \mathrm{GroupSim}(p, q) = \max_{a \in T_p, b \in T_q}S(a, b) \]</span></p>
<p>The term semantic similarity method and the IC method can be set via <code>control</code> argument, for example:</p>
<pre class="r">
group_sim(dag, group1, group2, method = "GroupSim_pairwise_max"
    control = list(term_sim_method = "Sim_Lin_1998", IC_method = "IC_annotation")`.
</pre>
<p>Other parameters for the <code>term_sim_method</code> can also be set in the <code>control</code> list.</p>
<p>Paper link: <a href="https://doi.org/10.1109/TCBB.2005.50" class="external-link uri">https://doi.org/10.1109/TCBB.2005.50</a>.</p>
</div>
<div class="section level3">
<h3 id="groupsim_pairwise_bma">GroupSim_pairwise_BMA<a class="anchor" aria-label="anchor" href="#groupsim_pairwise_bma"></a>
</h3>
<p>BMA stands for “best-match average”. First define similarity of a term <span class="math inline">\(x\)</span> to a group of terms <span class="math inline">\(T\)</span> as</p>
<p><span class="math display">\[ S(x, T) = \max_{y \in T} S(x, y) \]</span></p>
<p>which corresponds to the most similar term in <span class="math inline">\(T\)</span> to <span class="math inline">\(x\)</span>. Then the BMA similarity is calculated as:</p>
<p><span class="math display">\[ \mathrm{GroupSim}(p, q) = \frac{1}{2}\left( \frac{1}{|T_p|}\sum_{a \in T_p} S(a, T_q) + \frac{1}{|T_q|}\sum_{b \in T_q} S(b, T_p) \right) \]</span></p>
<p>The term semantic similarity method and the IC method can be set via <code>control</code> argument, for example:</p>
<pre class="r">
group_sim(dag, group1, group2, method = "GroupSim_pairwise_BMA"
    control = list(term_sim_method = "Sim_Lin_1998", IC_method = "IC_annotation")`.
</pre>
<p>Other parameters for the <code>term_sim_method</code> can also be set in the <code>control</code> list.</p>
<p>Paper link: <a href="https://doi.org/10.1155/2012/975783" class="external-link uri">https://doi.org/10.1155/2012/975783</a>.</p>
</div>
<div class="section level3">
<h3 id="groupsim_pairwise_bmm">GroupSim_pairwise_BMM<a class="anchor" aria-label="anchor" href="#groupsim_pairwise_bmm"></a>
</h3>
<p>BMM stands for “best-match max”. It is defined as:</p>
<p><span class="math display">\[ \mathrm{GroupSim}(p, q) = \max \left \{ \frac{1}{|T_p|}\sum_{a \in T_p} S(a, T_q), \frac{1}{|T_q|}\sum_{b \in T_q} S(b, T_p) \right \} \]</span></p>
<p>The term semantic similarity method and the IC method can be set via <code>control</code> argument, for example:</p>
<pre class="r">
group_sim(dag, group1, group2, method = "GroupSim_pairwise_BMM"
    control = list(term_sim_method = "Sim_Lin_1998", IC_method = "IC_annotation")`.
</pre>
<p>Other parameters for the <code>term_sim_method</code> can also be set in the <code>control</code> list.</p>
<p>Paper link: <a href="https://doi.org/10.1186/1471-2105-7-302" class="external-link uri">https://doi.org/10.1186/1471-2105-7-302</a>.</p>
</div>
<div class="section level3">
<h3 id="groupsim_pairwise_abm">GroupSim_pairwise_ABM<a class="anchor" aria-label="anchor" href="#groupsim_pairwise_abm"></a>
</h3>
<p>ABM stands for “average best-match”. It is defined as:</p>
<p><span class="math display">\[ \mathrm{GroupSim}(p, q) = \frac{1}{|T_q| + |T_q|} \left( \sum_{a \in T_p} S(a, T_q) + \sum_{b \in T_q} S(b, T_p) \right)  \]</span></p>
<p>The term semantic similarity method and the IC method can be set via <code>control</code> argument, for example:</p>
<pre class="r">
group_sim(dag, group1, group2, method = "GroupSim_pairwise_ABM"
    control = list(term_sim_method = "Sim_Lin_1998", IC_method = "IC_annotation")`.
</pre>
<p>Other parameters for the <code>term_sim_method</code> can also be set in the <code>control</code> list.</p>
<p>Paper link: <a href="https://doi.org/10.1186/1471-2105-14-284" class="external-link uri">https://doi.org/10.1186/1471-2105-14-284</a>.</p>
</div>
<div class="section level3">
<h3 id="groupsim_pairwise_hdf">GroupSim_pairwise_HDF<a class="anchor" aria-label="anchor" href="#groupsim_pairwise_hdf"></a>
</h3>
<p>First define the distance of a term <span class="math inline">\(x\)</span> to a group of terms <span class="math inline">\(T\)</span>:</p>
<p><span class="math display">\[D(x, T) = 1 - S(x, T)\]</span></p>
<p>Then the Hausdorff distance between two groups are:</p>
<p><span class="math display">\[ \mathrm{HDF}(p, q) = \max \left\{ \max_{a \in T_p} D(a, T_q), \max_{b \in T_q} D(b, T_q) \right\} \]</span></p>
<p>This final similarity is:</p>
<p><span class="math display">\[ \mathrm{GroupSim}(p, q) = 1 - \mathrm{HDF}(p, q) \]</span></p>
<p>The term semantic similarity method and the IC method can be set via <code>control</code> argument, for example:</p>
<pre class="r">
group_sim(dag, group1, group2, method = "GroupSim_pairwise_HDF"
    control = list(term_sim_method = "Sim_Lin_1998", IC_method = "IC_annotation")`.
</pre>
<p>Other parameters for the <code>term_sim_method</code> can also be set in the <code>control</code> list.</p>
</div>
<div class="section level3">
<h3 id="groupsim_pairwise_mhdf">GroupSim_pairwise_MHDF<a class="anchor" aria-label="anchor" href="#groupsim_pairwise_mhdf"></a>
</h3>
<p>Instead of using the maximal distance from a group to the other group, MHDF uses mean distance:</p>
<p><span class="math display">\[ \mathrm{MHDF}(p, q) = \max \left\{ \frac{1}{|T_p|} \sum_{a \in T_p} D(a, T_q), \frac{1}{|T_q|} \sum_{b \in T_q} D(b, T_q) \right\} \]</span></p>
<p>This final similarity is:</p>
<p><span class="math display">\[ \mathrm{GroupSim}(p, q) = 1 - \mathrm{MHDF}(p, q) \]</span></p>
<p>The term semantic similarity method and the IC method can be set via <code>control</code> argument, for example:</p>
<pre class="r">
group_sim(dag, group1, group2, method = "GroupSim_pairwise_MHDF"
    control = list(term_sim_method = "Sim_Lin_1998", IC_method = "IC_annotation")`.
</pre>
<p>Other parameters for the <code>term_sim_method</code> can also be set in the <code>control</code> list.</p>
<p>Paper link: <a href="https://doi.org/10.1109/ICPR.1994.576361" class="external-link uri">https://doi.org/10.1109/ICPR.1994.576361</a>.</p>
</div>
<div class="section level3">
<h3 id="groupsim_pairwise_vhdf">GroupSim_pairwise_VHDF<a class="anchor" aria-label="anchor" href="#groupsim_pairwise_vhdf"></a>
</h3>
<p>It is defined as:</p>
<p><span class="math display">\[ \mathrm{VHDF}(p, q) = \frac{1}{2} \left( \sqrt{\frac{1}{|T_p|} \sum_{a \in T_p} D^2(a, T_q)} + \sqrt{\frac{1}{|T_q|} \sum_{b \in T_q} D^2(b, T_q)} \right) \]</span></p>
<p>This final similarity is:</p>
<p><span class="math display">\[ \mathrm{GroupSim}(p, q) = 1 - \mathrm{VHDF}(p, q) \]</span></p>
<p>The term semantic similarity method and the IC method can be set via <code>control</code> argument, for example:</p>
<pre class="r">
group_sim(dag, group1, group2, method = "GroupSim_pairwise_VHDF"
    control = list(term_sim_method = "Sim_Lin_1998", IC_method = "IC_annotation")`.
</pre>
<p>Other parameters for the <code>term_sim_method</code> can also be set in the <code>control</code> list.</p>
<p>Paper link: <a href="https://doi.org/10.1073/pnas.0702965104" class="external-link uri">https://doi.org/10.1073/pnas.0702965104</a>.</p>
</div>
<div class="section level3">
<h3 id="groupsim_pairwise_froehlich_2007">GroupSim_pairwise_Froehlich_2007<a class="anchor" aria-label="anchor" href="#groupsim_pairwise_froehlich_2007"></a>
</h3>
<p>The similarity is:</p>
<p><span class="math display">\[ \mathrm{GroupSim}(p, q) = \exp(-\mathrm{HDF}(p, q)) \]</span></p>
<p>The term semantic similarity method and the IC method can be set via <code>control</code> argument, for example:</p>
<pre class="r">
group_sim(dag, group1, group2, method = "GroupSim_pairwise_Froehlich_2007"
    control = list(term_sim_method = "Sim_Lin_1998", IC_method = "IC_annotation")`.
</pre>
<p>Other parameters for the <code>term_sim_method</code> can also be set in the <code>control</code> list.</p>
<p>Paper link: <a href="https://doi.org/10.1186/1471-2105-8-166" class="external-link uri">https://doi.org/10.1186/1471-2105-8-166</a>.</p>
</div>
<div class="section level3">
<h3 id="groupsim_pairwise_joeng_2014">GroupSim_pairwise_Joeng_2014<a class="anchor" aria-label="anchor" href="#groupsim_pairwise_joeng_2014"></a>
</h3>
<p>Similar to VHDF, but it directly uses the similarity:</p>
<p><span class="math display">\[ \mathrm{GroupSim}(p, q) = \frac{1}{2} \left( \sqrt{\frac{1}{|T_p|} \sum_{a \in T_p} S^2(a, T_q)} + \sqrt{\frac{1}{|T_q|} \sum_{b \in T_q} S^2(b, T_q)} \right) \]</span></p>
<p>The term semantic similarity method and the IC method can be set via <code>control</code> argument, for example:</p>
<pre class="r">
group_sim(dag, group1, group2, method = "GroupSim_pairwise_Joeng_2014"
    control = list(term_sim_method = "Sim_Lin_1998", IC_method = "IC_annotation")`.
</pre>
<p>Other parameters for the <code>term_sim_method</code> can also be set in the <code>control</code> list.</p>
<p>Paper link: <a href="https://doi.org/10.1109/tcbb.2014.2343963" class="external-link uri">https://doi.org/10.1109/tcbb.2014.2343963</a>.</p>
</div>
</div>
<div class="section level2">
<h2 id="pairwise-edge-based-methods">Pairwise edge-based methods<a class="anchor" aria-label="anchor" href="#pairwise-edge-based-methods"></a>
</h2>
<div class="section level3">
<h3 id="groupsim_simaln">GroupSim_SimALN<a class="anchor" aria-label="anchor" href="#groupsim_simaln"></a>
</h3>
<p>It is based on the average distance between every pair of terms in the two groups:</p>
<p><span class="math display">\[ \mathrm{GroupSim}(p, q) = \exp\left(-\frac{1}{|T_p|*|T_q|} \sum_{a \in T_p, b \in T_q} D_\mathrm{sp}(a, b)\right) \]</span></p>
<p>Or use the longest distance between two terms:</p>
<p><span class="math display">\[ \mathrm{GroupSim}(p, q) = \exp\left(-\frac{1}{|T_p|*|T_q|} \sum_{a \in T_p, b \in T_q} \mathrm{len}(a, b)\right) \]</span></p>
<p>There is a parameter distance which takes value of <code>"longest_distances_via_LCA"</code> (the default) or <code>"shortest_distances_via_NCA"</code>:</p>
<pre class="r">
group_sim(dag, group1, group2, method = "GroupSim_SimALN",
    control = list(distance = "shortest_distances_via_NCA"))
</pre>
<p>Paper link: <a href="https://doi.org/10.1109/CBMS.2008.27" class="external-link uri">https://doi.org/10.1109/CBMS.2008.27</a>.</p>
</div>
</div>
<div class="section level2">
<h2 id="groupwise-ic-based-methods">Groupwise IC-based methods<a class="anchor" aria-label="anchor" href="#groupwise-ic-based-methods"></a>
</h2>
<p>This category of methods depend on the IC of terms in the two groups as well as their ancestor terms.</p>
<div class="section level3">
<h3 id="groupsim_simgic-groupsim_simdic-and-groupsim_simuic">GroupSim_SimGIC, GroupSim_SimDIC and GroupSim_SimUIC,<a class="anchor" aria-label="anchor" href="#groupsim_simgic-groupsim_simdic-and-groupsim_simuic"></a>
</h3>
<p>Denote <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> as the two sets of ancestors of terms in group <span class="math inline">\(p\)</span> and <span class="math inline">\(q\)</span> respectively:</p>
<p><span class="math display">\[
\begin{align*}
 \mathcal{A}_p &amp;= \bigcup_{a \in T_p} \mathcal{A}_a \\
 \mathcal{A}_q &amp;= \bigcup_{b \in T_q} \mathcal{A}_b \\
\end{align*}
\]</span></p>
<p>The <em>GroupSim_SimGIC</em>, <em>GroupSim_SimDIC</em> and <em>GroupSim_SimUIC</em> are very similar. They are based on the IC of the ancestor terms, defined as:</p>
<p><span class="math display">\[
\begin{align*}
 \mathrm{GroupSim}_\mathrm{SimGIC}(p, q) &amp;= \frac{\sum\limits_{x \in \mathcal{A}_p \cap \mathcal{A}_q} \mathrm{IC}(x)}{\sum\limits_{x \in \mathcal{A}_p \cup \mathcal{A}_q} \mathrm{IC}(x)} \\
 \mathrm{GroupSim}_\mathrm{SimDIC}(p, q) &amp;= \frac{2 * \sum\limits_{x \in \mathcal{A}_p \cap \mathcal{A}_q} \mathrm{IC}(x)}{\sum\limits_{x \in \mathcal{A}_p} \mathrm{IC}(x) + \sum\limits_{x \in \mathcal{A}_q} \mathrm{IC}(x)} \\
 \mathrm{GroupSim}_\mathrm{SimUIC}(p, q) &amp;= \frac{2 * \sum\limits_{x \in \mathcal{A}_p \cap \mathcal{A}_q} \mathrm{IC}(x)}{\max\left\{\sum\limits_{x \in \mathcal{A}_p} \mathrm{IC}(x), \sum\limits_{x \in \mathcal{A}_q} \mathrm{IC}(x) \right\}}  \\
\end{align*}
\]</span></p>
<p>IC method can be set via the <code>control</code> argument. By default if there is annotation associated, <em>IC_annotation</em> is used, or else <em>IC_offspring</em> is used.</p>
<pre class="r">
group_sim(dag, group1, group2, method = "GroupSim_SimGIC",
    control = list(IC_method = ...))
</pre>
</div>
<div class="section level3">
<h3 id="groupsim_simui-groupsim_simdb-groupsim_simub-and-groupsim_simnto">GroupSim_SimUI, GroupSim_SimDB, GroupSim_SimUB and GroupSim_SimNTO<a class="anchor" aria-label="anchor" href="#groupsim_simui-groupsim_simdb-groupsim_simub-and-groupsim_simnto"></a>
</h3>
<p>These four methods are based on the counts of ancestor terms:</p>
<p><span class="math display">\[
\begin{align*}
 \mathrm{GroupSim}_\mathrm{SimUI}(p, q) &amp;= \frac{|\mathcal{A}_p \cap \mathcal{A}_q|}{|\mathcal{A}_p \cup \mathcal{A}_q|} \\
 \mathrm{GroupSim}_\mathrm{SimDB}(p, q) &amp;= \frac{2*|\mathcal{A}_p \cap \mathcal{A}_q|}{|\mathcal{A}_p| +  |\mathcal{A}_q|} \\
 \mathrm{GroupSim}_\mathrm{SimUB}(p, q) &amp;= \frac{|\mathcal{A}_p \cap \mathcal{A}_q|}{\max\{|\mathcal{A}_p|,  |\mathcal{A}_q|\}} \\
 \mathrm{GroupSim}_\mathrm{SimNTO}(p, q) &amp;= \frac{|\mathcal{A}_p \cap \mathcal{A}_q|}{\min\{|\mathcal{A}_p|,  |\mathcal{A}_q|\}}
\end{align*}
\]</span></p>
<pre class="r">
group_sim(dag, group1, group2, method = "GroupSim_SimUI")
</pre>
</div>
<div class="section level3">
<h3 id="groupsim_simcou">GroupSim_SimCOU<a class="anchor" aria-label="anchor" href="#groupsim_simcou"></a>
</h3>
<p>Let’s write <span class="math inline">\(\mathcal{A}_p\)</span> and <span class="math inline">\(\mathcal{A}_q\)</span> as two vectors <span class="math inline">\(\mathbf{v_p}\)</span> and <span class="math inline">\(\mathbf{v_q}\)</span>. Taking <span class="math inline">\(\mathbf{v_p}\)</span> as an example, it is <span class="math inline">\(\mathbf{v_p} = (w_1, ..., w_n)\)</span> where <span class="math inline">\(n\)</span> is the number of total terms in the DAG. The value <span class="math inline">\(w_i\)</span> is assigned to the corresponding term <span class="math inline">\(t_i\)</span> and is defined as:</p>
<p><span class="math display">\[
\mathcal{w}_{i} = \left\{ \begin{array}{ll}
\mathrm{IC}(t_i) &amp; \textrm{if} t_i \in \mathcal{A}_p \\
0 &amp; \textrm{otherwise}
\end{array} \right.
\]</span></p>
<p>The semantic similarity is defined as the cosine similarity between the two vectors:</p>
<p><span class="math display">\[ \mathrm{GroupSim}(a, b) = \frac{ \mathbf{v_p} \cdot \mathbf{v_q} }{\left \| \mathbf{v_p} \right \| \cdot  \left \| \mathbf{v_q} \right \|} \]</span></p>
<p>It can also be written as:</p>
<p><span class="math display">\[ \mathrm{GroupSim}(a, b) = \frac{\sum\limits_{x \in \mathcal{A}_p \cap \mathcal{A}_q}\mathrm{IC}(x)^2}{\sqrt{\sum\limits_{x \in \mathcal{A}_p}\mathrm{IC}(x)^2} \cdot \sqrt{\sum\limits_{x \in \mathcal{A}_q}\mathrm{IC}(x)^2}} \]</span></p>
<p>IC method can be set via the <code>control</code> argument. By default if there is annotation associated, <em>IC_annotation</em> is used, or else <em>IC_offspring</em> is used.</p>
<pre class="r">
group_sim(dag, group1, group2, method = "GroupSim_SimCOU",
    control = list(IC_method = ...))
</pre>
</div>
<div class="section level3">
<h3 id="groupsim_simcot">GroupSim_SimCOT<a class="anchor" aria-label="anchor" href="#groupsim_simcot"></a>
</h3>
<p>The semantic similarity is defined as:</p>
<p><span class="math display">\[
\begin{align*}
 \mathrm{GroupSim}(a, b) &amp;= \frac{ \mathbf{v_p} \cdot \mathbf{v_q} }{\left \| \mathbf{v_p} \right \|^2 +  \left \| \mathbf{v_q} \right \|^2 - \mathbf{v_p} \cdot \mathbf{v_q}} \\
     &amp;=  \frac{\sum\limits_{x \in \mathcal{A}_p \cap \mathcal{A}_q}\mathrm{IC}(x)^2}{\sum\limits_{x \in \mathcal{A}_p \cup \mathcal{A}_q}\mathrm{IC}(x)^2}
\end{align*}
\]</span></p>
<p>IC method can be set via the <code>control</code> argument. By default if there is annotation associated, <em>IC_annotation</em> is used, or else <em>IC_offspring</em> is used.</p>
<pre class="r">
group_sim(dag, group1, group2, method = "GroupSim_SimCOT",
    control = list(IC_method = ...))
</pre>
</div>
</div>
<div class="section level2">
<h2 id="groupwise-edge-based-methods">Groupwise edge-based methods<a class="anchor" aria-label="anchor" href="#groupwise-edge-based-methods"></a>
</h2>
<div class="section level3">
<h3 id="groupsim_simlp">GroupSim_SimLP<a class="anchor" aria-label="anchor" href="#groupsim_simlp"></a>
</h3>
<p>It is the largest depth of terms in <span class="math inline">\(\mathcal{A}_p \cap \mathcal{A}_q\)</span>.</p>
<p><span class="math display">\[ \mathrm{GroupSim}(p, q) = \max\{\delta(t): t \in \mathcal{A}_p \cap \mathcal{A}_q\} \]</span></p>
<pre class="r">
group_sim(dag, group1, group2, method = "GroupSim_SimLP")
</pre>
<p>Link: <a href="https://bioconductor.org/packages/release/bioc/vignettes/GOstats/inst/doc/GOvis.html#go-induced-distances" class="external-link uri">https://bioconductor.org/packages/release/bioc/vignettes/GOstats/inst/doc/GOvis.html#go-induced-distances</a>.</p>
</div>
<div class="section level3">
<h3 id="groupsim_ye_2005">GroupSim_Ye_2005<a class="anchor" aria-label="anchor" href="#groupsim_ye_2005"></a>
</h3>
<p>It is a normalized version of <em>GroupSim_SimLP</em>:</p>
<p><span class="math display">\[
\begin{align*}
\mathrm{GroupSim}(p, q) &amp;= \max\left\{\frac{\delta(t) - \delta_\mathrm{min}}{\delta_\mathrm{max} - \delta_\mathrm{min}}: t \in \mathcal{A}_p \cap \mathcal{A}_q\right\} \\
    &amp;= \max\left\{\frac{\delta(t) }{\delta_\mathrm{max}}: t \in \mathcal{A}_p \cap \mathcal{A}_q\right\}
\end{align*}
\]</span></p>
<p>Since the minimal depth is zero for root.</p>
<pre class="r">
group_sim(dag, group1, group2, method = "GroupSim_Ye_2005")
</pre>
<p>Paper link: <a href="https://doi.org/10.1038/msb4100034" class="external-link uri">https://doi.org/10.1038/msb4100034</a>.</p>
</div>
</div>
<div class="section level2">
<h2 id="annotated-items-based-methods">Annotated items-based methods<a class="anchor" aria-label="anchor" href="#annotated-items-based-methods"></a>
</h2>
<p>This category of methods consider the items annotated to the two groups of terms.</p>
<div class="section level3">
<h3 id="groupsim_simcho">GroupSim_SimCHO<a class="anchor" aria-label="anchor" href="#groupsim_simcho"></a>
</h3>
<p>It is based on the annotated items. Denote <span class="math inline">\(\sigma(t)\)</span> as the total number of annotated items of <span class="math inline">\(t\)</span> (after merging all its offspring terms). The similarity is calculated as:</p>
<p><span class="math display">\[
\mathrm{GroupSim}(p, q) = \frac{\log(C_{pq})}{\log(C_\mathrm{min}/C_\mathrm{max})}
\]</span></p>
<p>where <span class="math inline">\(C_{pq} = \min\{\sigma(t): t \in T_p \cap T_q \}\)</span>, <span class="math inline">\(C_\mathrm{min}\)</span> is the minimal number of annotated items in the DAG which in most cases is 1, <span class="math inline">\(C_\mathrm{max}\)</span> is the maximal number of annotated items, which is the total number of items annotated to the complete DAG.</p>
<p>The similarity can also be written in form of <span class="math inline">\(\mathrm{IC}_\mathrm{anno}\)</span>:</p>
<p><span class="math display">\[
\mathrm{GroupSim}(p, q) = \frac{\max\limits_{x \in T_p \cup T_q}\mathrm{IC}(x)}{\mathrm{IC}_\mathrm{max}}
\]</span></p>
<pre class="r">
group_sim(dag, group1, group2, method = "GroupSim_SimCHO")
</pre>
</div>
<div class="section level3">
<h3 id="groupsim_simald">GroupSim_SimALD<a class="anchor" aria-label="anchor" href="#groupsim_simald"></a>
</h3>
<p>The similarity is calculated as:</p>
<p><span class="math display">\[ \mathrm{GroupSim}(p, q) = \max\left\{ 1 - \frac{\sigma(x)}{C_\mathrm{max}}: x \in T_p \cap T_q \right\} \]</span></p>
<pre class="r">
group_sim(dag, group1, group2, method = "GroupSim_SimALD")
</pre>
</div>
</div>
<div class="section level2">
<h2 id="set-based-methods">Set-based methods<a class="anchor" aria-label="anchor" href="#set-based-methods"></a>
</h2>
<p>Since <span class="math inline">\(T_p\)</span> and <span class="math inline">\(T_q\)</span> are two sets, the Kappa coeffcient, Jaccard coeffcient, Dice coeffcient and overlap coeffcient can be naturally used.</p>
<pre class="r">
group_sim(dag, group1, group2, method = "GroupSim_Jaccard", 
    control = list(universe = ...))
group_sim(dag, group1, group2, method = "GroupSim_Dice", 
    control = list(universe = ...))
group_sim(dag, group1, group2, method = "GroupSim_Overlap", 
    control = list(universe = ...))
group_sim(dag, group1, group2, method = "GroupSim_Kappa", 
    control = list(universe = ...))
</pre>
</div>
<div class="section level2">
<h2 id="session-info">Session info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h2>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## R version 4.3.1 (2023-06-16)</span></span>
<span><span class="co">## Platform: x86_64-apple-darwin20 (64-bit)</span></span>
<span><span class="co">## Running under: macOS Ventura 13.2.1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Matrix products: default</span></span>
<span><span class="co">## BLAS:   /Library/Frameworks/R.framework/Versions/4.3-x86_64/Resources/lib/libRblas.0.dylib </span></span>
<span><span class="co">## LAPACK: /Library/Frameworks/R.framework/Versions/4.3-x86_64/Resources/lib/libRlapack.dylib;  LAPACK version 3.11.0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## locale:</span></span>
<span><span class="co">## [1] C/UTF-8/C/C/C/C</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## time zone: Europe/Berlin</span></span>
<span><span class="co">## tzcode source: internal</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attached base packages:</span></span>
<span><span class="co">## [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## other attached packages:</span></span>
<span><span class="co">## [1] simona_0.99.7 knitr_1.44   </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## loaded via a namespace (and not attached):</span></span>
<span><span class="co">##  [1] sass_0.4.7            xml2_1.3.5            shape_1.4.6          </span></span>
<span><span class="co">##  [4] stringi_1.7.12        digest_0.6.33         magrittr_2.0.3       </span></span>
<span><span class="co">##  [7] evaluate_0.22         grid_4.3.1            RColorBrewer_1.1-3   </span></span>
<span><span class="co">## [10] iterators_1.0.14      circlize_0.4.15       fastmap_1.1.1        </span></span>
<span><span class="co">## [13] foreach_1.5.2         doParallel_1.0.17     rprojroot_2.0.3      </span></span>
<span><span class="co">## [16] jsonlite_1.8.7        GlobalOptions_0.1.2   ComplexHeatmap_2.16.0</span></span>
<span><span class="co">## [19] purrr_1.0.2           codetools_0.2-19      textshaping_0.3.6    </span></span>
<span><span class="co">## [22] jquerylib_0.1.4       cli_3.6.1             rlang_1.1.1          </span></span>
<span><span class="co">## [25] crayon_1.5.2          scatterplot3d_0.3-44  cachem_1.0.8         </span></span>
<span><span class="co">## [28] yaml_2.3.7            tools_4.3.1           parallel_4.3.1       </span></span>
<span><span class="co">## [31] memoise_2.0.1         colorspace_2.1-0      GetoptLong_1.0.5     </span></span>
<span><span class="co">## [34] BiocGenerics_0.46.0   TSP_1.2-4             vctrs_0.6.3          </span></span>
<span><span class="co">## [37] R6_2.5.1              png_0.1-8             matrixStats_1.0.0    </span></span>
<span><span class="co">## [40] stats4_4.3.1          lifecycle_1.0.3       stringr_1.5.0        </span></span>
<span><span class="co">## [43] S4Vectors_0.38.2      fs_1.6.3              IRanges_2.34.1       </span></span>
<span><span class="co">## [46] clue_0.3-65           cluster_2.1.4         ragg_1.2.5           </span></span>
<span><span class="co">## [49] pkgconfig_2.0.3       desc_1.4.2            pkgdown_2.0.7        </span></span>
<span><span class="co">## [52] bslib_0.5.1           Rcpp_1.0.11           glue_1.6.2           </span></span>
<span><span class="co">## [55] systemfonts_1.0.4     xfun_0.40             rjson_0.2.21         </span></span>
<span><span class="co">## [58] igraph_1.5.1          htmltools_0.5.6       rmarkdown_2.25       </span></span>
<span><span class="co">## [61] Polychrome_1.5.1      compiler_4.3.1</span></span></code></pre>
<script src="jquery.min.js"></script><script src="jquery.sticky.js"></script><script>
$(document).ready(function(){
    $("#TOC").sticky({
        topSpacing: 0,
        zIndex:1000    
    })
    $("#TOC").on("sticky-start", function() {

        $("<p style='font-size:1.2em; padding-left:4px;'><a id='TOC-click'>Table of Content</a></p>").insertBefore($("#TOC ul:first-child"));
        $("#TOC-click").hover(function() {
            $(this).css("color", "#0033dd").css("cursor", "pointer");
            $("#TOC").children().first().next().show();
            $("#TOC").hover(function() {
                $(this).children().first().next().show();
            }, function() {
                $(this).children().first().next().hide();
                $("body").off("hover", "#TOC");
            })
        }, function() {
            $(this).css("color", "#0033dd");
        })
        $("#TOC").children().first().next().hide();

    })
    $("#TOC").on("sticky-end", function() {
        $("#TOC").children().first().remove();
        $("#TOC").children().first().show();
    })
});
</script>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Zuguang Gu.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
