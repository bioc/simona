<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Functional enrichment • simona</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Functional enrichment">
<meta property="og:description" content="simona">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">simona</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.1.6</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/v01_dag.html">ontology_DAG: a class for ontology data</a>
    </li>
    <li>
      <a href="../articles/v02_GO.html">Gene Ontology</a>
    </li>
    <li>
      <a href="../articles/v03_import.html">Import ontology files</a>
    </li>
    <li>
      <a href="../articles/v04_information_content.html">Information content</a>
    </li>
    <li>
      <a href="../articles/v05_term_similarity.html">Term similarity</a>
    </li>
    <li>
      <a href="../articles/v06_group_similarity.html">Similarity between two groups of terms</a>
    </li>
    <li>
      <a href="../articles/v07_dag_visualization.html">Visualize DAGs</a>
    </li>
    <li>
      <a href="../articles/v08_random.html">Random DAGs</a>
    </li>
    <li>
      <a href="../articles/v09_shiny.html">Shiny app</a>
    </li>
    <li>
      <a href="../articles/v10_enrichment.html">Functional enrichment</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/jokergoo/simona/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Functional enrichment</h1>
                        <h4 data-toc-skip class="author">Zuguang Gu ( <a href="mailto:z.gu@dkfz.de" class="email">z.gu@dkfz.de</a> )</h4>
            
            <h4 data-toc-skip class="date">2023-12-14</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/jokergoo/simona/blob/HEAD/vignettes/v10_enrichment.Rmd" class="external-link"><code>vignettes/v10_enrichment.Rmd</code></a></small>
      <div class="hidden name"><code>v10_enrichment.Rmd</code></div>

    </div>

    
    
<p>In many applications, semantic similarity analysis is integerated with gene set enrichment analysis, especially taking GO as the source of gene sets. <strong>simona</strong> provides functions that import ontologies already integrated with gene annotations. <strong>simona</strong> also provides functions for over-representation analysis (ORA) and functions to integrate the ORA results with semantic similarity analysis.</p>
<div class="section level2">
<h2 id="go">GO<a class="anchor" aria-label="anchor" href="#go"></a>
</h2>
<p>To add gene annotations for GO, just set the name of the “org.db” package for the specific organism. For example “org.Hs.eg.db” for human and “org.Mm.eg.db” for mouse. The full list of supported “org.db” packages can be found at <a href="https://bioconductor.org/packages/release/BiocViews.html#___AnnotationData" class="external-link uri">https://bioconductor.org/packages/release/BiocViews.html#___AnnotationData</a> (search <code>"org."</code>).</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jokergoo/simona" class="external-link">simona</a></span><span class="op">)</span></span>
<span><span class="va">dag</span> <span class="op">=</span> <span class="fu"><a href="../reference/create_ontology_DAG_from_GO_db.html">create_ontology_DAG_from_GO_db</a></span><span class="op">(</span>org_db <span class="op">=</span> <span class="st">"org.Hs.eg.db"</span><span class="op">)</span></span>
<span><span class="va">dag</span></span></code></pre></div>
<pre><code><span><span class="co">## An ontology_DAG object:</span></span>
<span><span class="co">##   Source: GO BP / GO.db package 3.17.0 </span></span>
<span><span class="co">##   27942 terms / 55956 relations</span></span>
<span><span class="co">##   Root: GO:0008150 </span></span>
<span><span class="co">##   Terms: GO:0000001, GO:0000002, GO:0000003, GO:0000011, ...</span></span>
<span><span class="co">##   Max depth: 18 </span></span>
<span><span class="co">##   Avg number of parents: 2.00</span></span>
<span><span class="co">##   Avg number of children: 1.88</span></span>
<span><span class="co">##   Aspect ratio: 363.92:1 (based on the longest distance from root)</span></span>
<span><span class="co">##                 782.78:1 (based on the shortest distance from root)</span></span>
<span><span class="co">##   Relations: is_a, part_of</span></span>
<span><span class="co">##   Annotations: 18614 items</span></span>
<span><span class="co">##                291, 1890, 4205, 4358, ...</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## With the following columns in the metadata data frame:</span></span>
<span><span class="co">##   id, name, definition</span></span></code></pre>
<p>As the object <code>dag</code> prints, the genes stored in <code>dag</code> are in the EntreZ ID type. So when doing ORA, the input gene list should also be in the EntreZ ID type.</p>
<p>We generate a list of random genes for testing:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">888</span><span class="op">)</span></span>
<span><span class="va">genes</span> <span class="op">=</span> <span class="fu"><a href="../reference/random_terms.html">random_items</a></span><span class="op">(</span><span class="va">dag</span>, <span class="fl">500</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">genes</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "9820"      "7187"      "7694"      "100628315" "252969"    "51042"</span></span></code></pre>
<p>To perform ORA, use the function <code><a href="../reference/dag_enrich_on_items.html">dag_enrich_on_genes()</a></code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tb</span> <span class="op">=</span> <span class="fu"><a href="../reference/dag_enrich_on_items.html">dag_enrich_on_genes</a></span><span class="op">(</span><span class="va">dag</span>, <span class="va">genes</span><span class="op">)</span></span>
<span><span class="va">tb</span> <span class="op">=</span> <span class="va">tb</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">tb</span><span class="op">$</span><span class="va">p_adjust</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">tb</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                  term</span></span>
<span><span class="co">## GO:0016567 GO:0016567</span></span>
<span><span class="co">## GO:0032446 GO:0032446</span></span>
<span><span class="co">## GO:0045930 GO:0045930</span></span>
<span><span class="co">## GO:0070647 GO:0070647</span></span>
<span><span class="co">## GO:1901991 GO:1901991</span></span>
<span><span class="co">## GO:0031648 GO:0031648</span></span>
<span><span class="co">##                                                                    name n_hits</span></span>
<span><span class="co">## GO:0016567                                       protein ubiquitination     35</span></span>
<span><span class="co">## GO:0032446            protein modification by small protein conjugation     36</span></span>
<span><span class="co">## GO:0045930                    negative regulation of mitotic cell cycle     16</span></span>
<span><span class="co">## GO:0070647 protein modification by small protein conjugation or removal     41</span></span>
<span><span class="co">## GO:1901991   negative regulation of mitotic cell cycle phase transition     13</span></span>
<span><span class="co">## GO:0031648                                      protein destabilization      6</span></span>
<span><span class="co">##            n_anno n_items n_all log2_fold_enrichment  z_score      p_value</span></span>
<span><span class="co">## GO:0016567    682     500 18614            0.9339713 4.024918 0.0002039164</span></span>
<span><span class="co">## GO:0032446    756     500 18614            0.8259988 3.603929 0.0006735261</span></span>
<span><span class="co">## GO:0045930    226     500 18614            1.3981372 4.110105 0.0004211551</span></span>
<span><span class="co">## GO:0070647    897     500 18614            0.7669040 3.578373 0.0006562499</span></span>
<span><span class="co">## GO:1901991    179     500 18614            1.4349401 3.805279 0.0011276793</span></span>
<span><span class="co">## GO:0031648     48     500 18614            2.2183162 4.210722 0.0017186058</span></span>
<span><span class="co">##             p_adjust depth</span></span>
<span><span class="co">## GO:0016567 0.1976799     8</span></span>
<span><span class="co">## GO:0032446 0.1976799     7</span></span>
<span><span class="co">## GO:0045930 0.1976799     6</span></span>
<span><span class="co">## GO:0070647 0.1976799     6</span></span>
<span><span class="co">## GO:1901991 0.2647791     8</span></span>
<span><span class="co">## GO:0031648 0.3362739     4</span></span></code></pre>
<p>We can take the significant GO terms and look at their semantic similarities.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">top_go_ids</span> <span class="op">=</span> <span class="va">tb</span><span class="op">$</span><span class="va">term</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">200</span><span class="op">]</span></span>
<span><span class="va">mat</span> <span class="op">=</span> <span class="fu"><a href="../reference/term_sim.html">term_sim</a></span><span class="op">(</span><span class="va">dag</span>, <span class="va">top_go_ids</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jokergoo/ComplexHeatmap" class="external-link">ComplexHeatmap</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html" class="external-link">Heatmap</a></span><span class="op">(</span><span class="va">mat</span>, name <span class="op">=</span> <span class="st">"similarity"</span>, </span>
<span>    show_row_names <span class="op">=</span> <span class="cn">FALSE</span>, show_column_names <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    show_row_dend <span class="op">=</span> <span class="cn">FALSE</span>, show_column_dend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="v10_enrichment_files/figure-html/unnamed-chunk-7-1.png" width="624" style="display: block; margin: auto;"></p>
<p>And the significant GO terms on the global circular plot:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/dag_viz.html">dag_circular_viz</a></span><span class="op">(</span><span class="va">dag</span>, <span class="va">top_go_ids</span><span class="op">)</span></span></code></pre></div>
<p><img src="v10_enrichment_files/figure-html/unnamed-chunk-8-1.png" width="864" style="display: block; margin: auto;"></p>
<p>One of the use of the semantic similarity matrix is to cluster GO terms in groups, to simplify the read of the results. Here the semantic similarity matrix can be directly sent to <code><a href="https://rdrr.io/pkg/simplifyEnrichment/man/simplifyEnrichment.html" class="external-link">simplifyEnrichment()</a></code> function from the <strong>simplifyEnrichment</strong> package. Since the terms are from GO, there will be word cloud associated with the heatmap to show their generl biological functions in each cluster.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jokergoo/simplifyEnrichment" class="external-link">simplifyEnrichment</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/simplifyEnrichment/man/simplifyEnrichment.html" class="external-link">simplifyEnrichment</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span></span></code></pre></div>
<p><img src="v10_enrichment_files/figure-html/unnamed-chunk-9-1.png" width="816" style="display: block; margin: auto;"></p>
<p>In the previous example, when setting the organism, we use the name of the <code>org.db</code> package. The value can also directly be an <code>OrgDb</code> object. This expands the use of the function since there are many <code>OrgDb</code> objects for less-studied organims available on <strong>AnnotationHub</strong>.</p>
<p>The following code demonstrates the use of the delphin organism (Delphinus truncatus). <code>AH112417</code> is the ID of this dataset. Please refer to <strong>AnnotationHub</strong> for the usage of the package.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">AnnotationHub</span><span class="op">)</span></span>
<span><span class="va">ah</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/AnnotationHub/man/AnnotationHub-class.html" class="external-link">AnnotationHub</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">org_db</span> <span class="op">=</span> <span class="va">ah</span><span class="op">[[</span><span class="st">"AH112417"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">dag</span> <span class="op">=</span> <span class="fu"><a href="../reference/create_ontology_DAG_from_GO_db.html">create_ontology_DAG_from_GO_db</a></span><span class="op">(</span>org_db <span class="op">=</span> <span class="va">org_db</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="other-ontologies">Other ontologies<a class="anchor" aria-label="anchor" href="#other-ontologies"></a>
</h2>
<p>Besides GO, there are also other ontologies that have gene annotations integrated.</p>
<div class="section level3">
<h3 id="uniprot-keywords">UniProt Keywords<a class="anchor" aria-label="anchor" href="#uniprot-keywords"></a>
</h3>
<p>UniProt Keywords (<a href="https://www.uniprot.org/keywords" class="external-link uri">https://www.uniprot.org/keywords</a>) is a set of controlled vocabulary developed in UniProt to describe the biological functions of proteins. It is organised in a hierarchical way, thus in a form of the ontology. The function <code><a href="../reference/ontology.html">ontology_kw()</a></code> can import the UniProt Keywords ontology with gene annotations from a specific organims.</p>
<p>The function internally uses the <strong>UniProtKeywords</strong> package. All supported organisms can be found in the documentation of <code><a href="https://rdrr.io/pkg/UniProtKeywords/man/load_keyword_genesets.html" class="external-link">UniProtKeywords::load_keyword_genesets()</a></code>.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dag</span> <span class="op">=</span> <span class="fu"><a href="../reference/ontology.html">ontology_kw</a></span><span class="op">(</span><span class="st">"human"</span><span class="op">)</span></span>
<span><span class="va">dag</span></span></code></pre></div>
<pre><code><span><span class="co">## An ontology_DAG object:</span></span>
<span><span class="co">##   Source: UniProt Keywords </span></span>
<span><span class="co">##   1202 terms / 1348 relations</span></span>
<span><span class="co">##   Root: ~~all~~ </span></span>
<span><span class="co">##   Terms: 2Fe-2S, 3D-structure, 3Fe-4S, 4Fe-4S, ...</span></span>
<span><span class="co">##   Max depth: 6 </span></span>
<span><span class="co">##   Avg number of parents: 1.12</span></span>
<span><span class="co">##   Avg number of children: 1.07</span></span>
<span><span class="co">##   Aspect ratio: 111.83:1 (based on the longest distance from root)</span></span>
<span><span class="co">##                 119.83:1 (based on the shortest distance from root)</span></span>
<span><span class="co">##   Annotations: 18689 items</span></span>
<span><span class="co">##                2230, 150209, 316, 55847, ...</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## With the following columns in the metadata data frame:</span></span>
<span><span class="co">##   id, accession, name, description, category</span></span></code></pre>
<p>As <code>dag</code> shows, the gene ID type is EntreZ ID. Similar as GO, we randomly generate a list of genes and perform ORA.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">genes</span> <span class="op">=</span> <span class="fu"><a href="../reference/random_terms.html">random_items</a></span><span class="op">(</span><span class="va">dag</span>, <span class="fl">500</span><span class="op">)</span></span>
<span><span class="va">tb</span> <span class="op">=</span> <span class="fu"><a href="../reference/dag_enrich_on_items.html">dag_enrich_on_genes</a></span><span class="op">(</span><span class="va">dag</span>, <span class="va">genes</span><span class="op">)</span></span>
<span><span class="va">tb</span> <span class="op">=</span> <span class="va">tb</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">tb</span><span class="op">$</span><span class="va">p_adjust</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="va">top_go_ids</span> <span class="op">=</span> <span class="va">tb</span><span class="op">$</span><span class="va">term</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">50</span><span class="op">]</span></span></code></pre></div>
<p>Obtain the semantic similarity matrix and make plots:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mat</span> <span class="op">=</span> <span class="fu"><a href="../reference/term_sim.html">term_sim</a></span><span class="op">(</span><span class="va">dag</span>, <span class="va">top_go_ids</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html" class="external-link">Heatmap</a></span><span class="op">(</span><span class="va">mat</span>, name <span class="op">=</span> <span class="st">"similarity"</span>, </span>
<span>    show_row_names <span class="op">=</span> <span class="cn">FALSE</span>, show_column_names <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    show_row_dend <span class="op">=</span> <span class="cn">FALSE</span>, show_column_dend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="v10_enrichment_files/figure-html/unnamed-chunk-13-1.png" width="624" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/dag_viz.html">dag_circular_viz</a></span><span class="op">(</span><span class="va">dag</span>, <span class="va">top_go_ids</span><span class="op">)</span></span></code></pre></div>
<p><img src="v10_enrichment_files/figure-html/unnamed-chunk-14-1.png" width="864" style="display: block; margin: auto;"></p>
<p>We also also use <code><a href="https://rdrr.io/pkg/simplifyEnrichment/man/simplifyEnrichment.html" class="external-link">simplifyEnrichment()</a></code> to cluster terms in <code>mat</code>, but there is no word cloud around the heatmap.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cl</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/simplifyEnrichment/man/simplifyEnrichment.html" class="external-link">simplifyEnrichment</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span></span></code></pre></div>
<p><img src="v10_enrichment_files/figure-html/unnamed-chunk-15-1.png" width="528" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">cl</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                              id cluster</span></span>
<span><span class="co">## 1                  Angiogenesis       1</span></span>
<span><span class="co">## 2                     Apoptosis       1</span></span>
<span><span class="co">## 3                      Cataract       2</span></span>
<span><span class="co">## 4 Cilium biogenesis/degradation       1</span></span>
<span><span class="co">## 5                       Disease       2</span></span>
<span><span class="co">## 6           Glycosyltransferase       3</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="ontologies-from-rgd">Ontologies from RGD<a class="anchor" aria-label="anchor" href="#ontologies-from-rgd"></a>
</h3>
<p>The following ontologies as well as the gene annotations are from the Rat Genome Database (RGD). Although the RGD is a database for mouse, it also provides gene annotations for other oganisms. The specific files used in each function can be found at <a href="https://download.rgd.mcw.edu/ontology/" class="external-link uri">https://download.rgd.mcw.edu/ontology/</a>.</p>
<p>Note that the following functions may support different sets of organims. Please go to the documentations for the list.</p>
<p><strong>Pathway Ontology</strong></p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dag</span> <span class="op">=</span> <span class="fu"><a href="../reference/ontology.html">ontology_pw</a></span><span class="op">(</span><span class="st">"human"</span><span class="op">)</span></span>
<span><span class="va">dag</span></span></code></pre></div>
<pre><code><span><span class="co">## An ontology_DAG object:</span></span>
<span><span class="co">##   Source: pw, 7.82 </span></span>
<span><span class="co">##   2593 terms / 3182 relations</span></span>
<span><span class="co">##   Root: ~~all~~ </span></span>
<span><span class="co">##   Terms: PW:0000001, PW:0000002, PW:0000003, PW:0000004, ...</span></span>
<span><span class="co">##   Max depth: 10 </span></span>
<span><span class="co">##   Avg number of parents: 1.23</span></span>
<span><span class="co">##   Avg number of children: 1.26</span></span>
<span><span class="co">##   Aspect ratio: 79.44:1 (based on the longest distance from root)</span></span>
<span><span class="co">##                 94.75:1 (based on the shortest distance from root)</span></span>
<span><span class="co">##   Relations: is_a</span></span>
<span><span class="co">##   Annotations: 5956 items</span></span>
<span><span class="co">##                CACNA1C, MAP3K3, RASGRP3, MAP3K6, ...</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## With the following columns in the metadata data frame:</span></span>
<span><span class="co">##   id, short_id, name, namespace, definition</span></span></code></pre>
<p>Note that, in the pathway ontology, genes are saved in gene symbols.</p>
<p>To perform enrichment analysis on the pathway ontology:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># `genes` must be in symbols</span></span>
<span><span class="va">tb</span> <span class="op">=</span> <span class="fu"><a href="../reference/dag_enrich_on_items.html">dag_enrich_on_genes</a></span><span class="op">(</span><span class="va">dag</span>, <span class="va">genes</span><span class="op">)</span></span></code></pre></div>
<p><strong>Chemical Entities of Biological Interest</strong></p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dag</span> <span class="op">=</span> <span class="fu"><a href="../reference/ontology.html">ontology_chebi</a></span><span class="op">(</span><span class="st">"human"</span><span class="op">)</span></span></code></pre></div>
<p>To perform enrichment analysis on CheBi:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># `genes` must be in symbols</span></span>
<span><span class="va">tb</span> <span class="op">=</span> <span class="fu"><a href="../reference/dag_enrich_on_items.html">dag_enrich_on_genes</a></span><span class="op">(</span><span class="va">dag</span>, <span class="va">genes</span><span class="op">)</span></span></code></pre></div>
<p><strong>Disease Ontology</strong></p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dag</span> <span class="op">=</span> <span class="fu"><a href="../reference/ontology.html">ontology_rdo</a></span><span class="op">(</span><span class="st">"human"</span><span class="op">)</span></span></code></pre></div>
<p>To perform enrichment analysis on the disease ontology:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># `genes` must be in symbols</span></span>
<span><span class="va">tb</span> <span class="op">=</span> <span class="fu"><a href="../reference/dag_enrich_on_items.html">dag_enrich_on_genes</a></span><span class="op">(</span><span class="va">dag</span>, <span class="va">genes</span><span class="op">)</span></span></code></pre></div>
<p><strong>Vertebrate Trait Ontology</strong></p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dag</span> <span class="op">=</span> <span class="fu"><a href="../reference/ontology.html">ontology_vt</a></span><span class="op">(</span><span class="st">"human"</span><span class="op">)</span></span></code></pre></div>
<p>To perform enrichment analysis on the vertebrate trait ontology:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># `genes` must be in symbols</span></span>
<span><span class="va">tb</span> <span class="op">=</span> <span class="fu"><a href="../reference/dag_enrich_on_items.html">dag_enrich_on_genes</a></span><span class="op">(</span><span class="va">dag</span>, <span class="va">genes</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="session-info">Session info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h2>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## R version 4.3.1 (2023-06-16)</span></span>
<span><span class="co">## Platform: x86_64-apple-darwin20 (64-bit)</span></span>
<span><span class="co">## Running under: macOS Ventura 13.2.1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Matrix products: default</span></span>
<span><span class="co">## BLAS:   /Library/Frameworks/R.framework/Versions/4.3-x86_64/Resources/lib/libRblas.0.dylib </span></span>
<span><span class="co">## LAPACK: /Library/Frameworks/R.framework/Versions/4.3-x86_64/Resources/lib/libRlapack.dylib;  LAPACK version 3.11.0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## locale:</span></span>
<span><span class="co">## [1] C/UTF-8/C/C/C/C</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## time zone: Europe/Berlin</span></span>
<span><span class="co">## tzcode source: internal</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attached base packages:</span></span>
<span><span class="co">## [1] grid      stats     graphics  grDevices utils     datasets  methods  </span></span>
<span><span class="co">## [8] base     </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## other attached packages:</span></span>
<span><span class="co">## [1] simplifyEnrichment_1.11.1 BiocGenerics_0.46.0      </span></span>
<span><span class="co">## [3] ComplexHeatmap_2.16.0     simona_1.1.6             </span></span>
<span><span class="co">## [5] knitr_1.44               </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## loaded via a namespace (and not attached):</span></span>
<span><span class="co">##  [1] blob_1.2.4              Biostrings_2.68.1       bitops_1.0-7           </span></span>
<span><span class="co">##  [4] fastmap_1.1.1           RCurl_1.98-1.12         UniProtKeywords_0.99.6 </span></span>
<span><span class="co">##  [7] promises_1.2.1          digest_0.6.33           mime_0.12              </span></span>
<span><span class="co">## [10] lifecycle_1.0.3         cluster_2.1.4           ellipsis_0.3.2         </span></span>
<span><span class="co">## [13] NLP_0.2-1               KEGGREST_1.40.1         RSQLite_2.3.1          </span></span>
<span><span class="co">## [16] magrittr_2.0.3          compiler_4.3.1          rlang_1.1.1            </span></span>
<span><span class="co">## [19] sass_0.4.7              tools_4.3.1             igraph_1.5.1           </span></span>
<span><span class="co">## [22] yaml_2.3.7              bit_4.0.5               scatterplot3d_0.3-44   </span></span>
<span><span class="co">## [25] xml2_1.3.5              RColorBrewer_1.1-3      purrr_1.0.2            </span></span>
<span><span class="co">## [28] desc_1.4.2              stats4_4.3.1            GOSemSim_2.26.1        </span></span>
<span><span class="co">## [31] tm_0.7-11               xtable_1.8-4            colorspace_2.1-0       </span></span>
<span><span class="co">## [34] GO.db_3.17.0            iterators_1.0.14        cli_3.6.1              </span></span>
<span><span class="co">## [37] rmarkdown_2.25          crayon_1.5.2            ragg_1.2.6             </span></span>
<span><span class="co">## [40] RcppParallel_5.1.7      httr_1.4.7              rjson_0.2.21           </span></span>
<span><span class="co">## [43] DBI_1.1.3               cachem_1.0.8            stringr_1.5.0          </span></span>
<span><span class="co">## [46] zlibbioc_1.46.0         parallel_4.3.1          AnnotationDbi_1.62.2   </span></span>
<span><span class="co">## [49] XVector_0.40.0          proxyC_0.3.3            matrixStats_1.0.0      </span></span>
<span><span class="co">## [52] vctrs_0.6.4             Matrix_1.6-1.1          slam_0.1-50            </span></span>
<span><span class="co">## [55] jsonlite_1.8.7          IRanges_2.34.1          GetoptLong_1.0.5       </span></span>
<span><span class="co">## [58] S4Vectors_0.38.2        bit64_4.0.5             clue_0.3-65            </span></span>
<span><span class="co">## [61] magick_2.8.0            systemfonts_1.0.5       foreach_1.5.2          </span></span>
<span><span class="co">## [64] jquerylib_0.1.4         glue_1.6.2              pkgdown_2.0.7          </span></span>
<span><span class="co">## [67] codetools_0.2-19        stringi_1.7.12          Polychrome_1.5.1       </span></span>
<span><span class="co">## [70] shape_1.4.6             later_1.3.1             GenomeInfoDb_1.36.4    </span></span>
<span><span class="co">## [73] htmltools_0.5.6.1       GenomeInfoDbData_1.2.10 circlize_0.4.15        </span></span>
<span><span class="co">## [76] R6_2.5.1                textshaping_0.3.7       doParallel_1.0.17      </span></span>
<span><span class="co">## [79] rprojroot_2.0.3         lattice_0.21-9          evaluate_0.22          </span></span>
<span><span class="co">## [82] shiny_1.6.0             Biobase_2.60.0          png_0.1-8              </span></span>
<span><span class="co">## [85] memoise_2.0.1           httpuv_1.6.11           bslib_0.5.1            </span></span>
<span><span class="co">## [88] Rcpp_1.0.11             org.Hs.eg.db_3.17.0     xfun_0.40              </span></span>
<span><span class="co">## [91] fs_1.6.3                pkgconfig_2.0.3         GlobalOptions_0.1.2</span></span></code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Zuguang Gu.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
