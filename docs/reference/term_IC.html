<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Information content — term_IC • simone</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Information content — term_IC"><meta property="og:description" content="Information content"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">simone</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.99.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/v1_dag.html">ontology_DAG: a class for ontologies</a>
    </li>
    <li>
      <a href="../articles/v2_GO.html">Gene Ontology</a>
    </li>
    <li>
      <a href="../articles/v3_import.html">Import ontology files</a>
    </li>
    <li>
      <a href="../articles/v4_information_content.html">Information content</a>
    </li>
    <li>
      <a href="../articles/v5_term_similarity.html">Term similarity</a>
    </li>
    <li>
      <a href="../articles/v6_group_similarity.html">Similarity between two groups of terms</a>
    </li>
    <li>
      <a href="../articles/v7_dag_visualization.html">Visualize DAGs</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/jokergoo/simone/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Information content</h1>
    <small class="dont-index">Source: <a href="https://github.com/jokergoo/simone/blob/HEAD/R/methods.R" class="external-link"><code>R/methods.R</code></a></small>
    <div class="hidden name"><code>term_IC.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Information content</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">term_IC</span><span class="op">(</span><span class="va">dag</span>, <span class="va">method</span>, terms <span class="op">=</span> <span class="cn">NULL</span>, control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>dag</dt>
<dd><p>An <code>ontology_DAG</code> object.</p></dd>


<dt>method</dt>
<dd><p>An IC method. All available methods are in <code><a href="all_methods.html">all_ic_methods()</a></code>.</p></dd>


<dt>terms</dt>
<dd><p>A vector of term names. If it is set, the returned vector will be subsetted to the terms that have been set here.</p></dd>


<dt>control</dt>
<dd><p>A list of parameters passing to individual methods. See the subsections.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A numeric vector.</p>
    </div>
    <div id="methods">
    <h2>Methods</h2>
    

<div class="section">
<h3 id="ic-offspring">IC_offspring<a class="anchor" aria-label="anchor" href="#ic-offspring"></a></h3>


<p>Denote <code>k</code> as the number of offspring terms plus the term itself and <code>N</code> is such value for root (or the total number of terms in the DAG), the information
content is calculated as:</p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>IC <span class="ot">=</span> <span class="sc">-</span><span class="fu">log</span>(k<span class="sc">/</span>N)</span></code></pre><p></p></div>
</div>


<div class="section">
<h3 id="ic-height">IC_height<a class="anchor" aria-label="anchor" href="#ic-height"></a></h3>


<p>For a term <code>t</code> in the DAG, denote <code>d</code> as the maximal distance from root (i.e. the depth) and <code>h</code> as the maximal distance to leaves (i.e. the height),
the relative position <code>p</code> on the longest path from root to leaves via term <code>t</code> is calculated as:</p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">=</span> (h <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">/</span>(h <span class="sc">+</span> d <span class="sc">+</span> <span class="dv">1</span>)</span></code></pre><p></p></div>
<p>In the formula where 1 is added gets rid of <code>p = 0</code>. Then the information content is:</p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>IC <span class="ot">=</span> <span class="sc">-</span><span class="fu">log</span>(p) </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>   <span class="ot">=</span> <span class="sc">-</span><span class="fu">log</span>((h<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span>(h<span class="sc">+</span>d<span class="sc">+</span><span class="dv">1</span>))</span></code></pre><p></p></div>
</div>


<div class="section">
<h3 id="ic-annotation">IC_annotation<a class="anchor" aria-label="anchor" href="#ic-annotation"></a></h3>


<p>Denote <code>k</code> as the number of items annotated to a term <code>t</code>, and <code>N</code> is the number of items annotated to the root (which is
the total number of items annotated to the DAG), IC for term <code>t</code> is calculated as:</p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>IC <span class="ot">=</span> <span class="sc">-</span><span class="fu">log</span>(k<span class="sc">/</span>N)</span></code></pre><p></p></div>
<p>In current implementations in other tools, there is an inconsistency of defining <code>k</code> and <code>N</code>.
Please see <code><a href="n_annotations.html">n_annotations()</a></code> for explanation.</p>
<p><code>NA</code> is assigned to the terms with no item annotated.</p>
</div>


<div class="section">
<h3 id="ic-universal">IC_universal<a class="anchor" aria-label="anchor" href="#ic-universal"></a></h3>


<p>It measures the probability of a term getting full transmission from the root. Each term is associated with a p-value and the root has
the p-value of 1.</p>
<p>For example, an intermediate term <code>t</code> has two parent terms <code>parent1</code> and <code>parent2</code>, also assume <code>parent1</code> has <code>k1</code> children
and <code>parent2</code> has <code>k2</code> children, assume a parent transmits information equally to all its children, then <code>parent1</code> only transmits <code>1/k1</code> and
<code>parent2</code> only transmits <code>1/k2</code> of its content to term <code>t</code>, or the probability of a parent to reach <code>t</code> is <code>1/k1</code> or <code>1/k2</code>.
Let's say <code>p1</code> and <code>p2</code> are the accmulated contents from the root for <code>parnet1</code> and <code>parent2</code> respectively (or the probability
of the two parent terms getting full transmission from root), then the probability of reaching <code>t</code> via a full transmission graph from <code>parent1</code>
is the multiplication of <code>p1</code> and <code>1/k1</code>, which is <code>p1/k1</code>, and it is similar for <code>p2/k2</code>. Then, for term <code>t</code>, if getting transmitted from <code>parent1</code> and
<code>parent2</code> are independent, the probability of <code>t</code> (denoted as <code>p_t</code>) to get transmitted from both parents is:</p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>p_t <span class="ot">=</span> (p1<span class="sc">/</span>k1) <span class="sc">*</span> (p2<span class="sc">/</span>k2)</span></code></pre><p></p></div>
<p>Since the two parents are the full set of <code>t</code>'s parents, <code>p_t</code> is the probability of <code>t</code> getting full transmission from root. And the final
information content is:</p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>IC <span class="ot">=</span> <span class="sc">-</span><span class="fu">log</span>(p_t)</span></code></pre><p></p></div>
<p>Paper link: <a href="https://doi.org/10.1155/2012/975783" class="external-link">https://doi.org/10.1155/2012/975783</a>.</p>
</div>


<div class="section">
<h3 id="ic-zhang-">IC_Zhang_2006<a class="anchor" aria-label="anchor" href="#ic-zhang-"></a></h3>


<p>It measures the number of ways from a term to reach leaf terms. E.g. in the following DAG:</p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>     a      upstream</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>    <span class="sc">/</span><span class="er">|</span>\</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>   b <span class="sc">|</span> c</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>     <span class="sc">|</span><span class="er">/</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>     d      downstream</span></code></pre><p></p></div>
<p>term <code>a</code> has three ways to reach leaf, which are <code>a-&gt;b</code>, <code>a-&gt;d</code> and <code>a-&gt;c-&gt;d</code>.</p>
<p>Let's denote <code>k</code> as the number of ways for term <code>t</code> to reach leaves and <code>N</code> as the maximal value of <code>k</code> which
should be associated with the root term, the information content is calculated as</p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>IC <span class="ot">=</span> <span class="sc">-</span><span class="fu">log</span>(k<span class="sc">/</span>N) </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>   <span class="ot">=</span> <span class="fu">log</span>(N) <span class="sc">-</span> <span class="fu">log</span>(k)</span></code></pre><p></p></div>
<p>Paper link: <a href="https://doi.org/10.1186/1471-2105-7-135" class="external-link">https://doi.org/10.1186/1471-2105-7-135</a>.</p>
</div>


<div class="section">
<h3 id="ic-seco-">IC_Seco_2004<a class="anchor" aria-label="anchor" href="#ic-seco-"></a></h3>


<p>It is based on the number of offspring terms of term <code>t</code>.
The information content is calculated as:</p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>IC <span class="ot">=</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">log</span>(k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="fu">log</span>(N)</span></code></pre><p></p></div>
<p>where <code>k</code> is the number of offspring terms of <code>t</code>, or you can think <code>k+1</code> is the number of <code>t</code>'s offspring terms plus itself.
<code>N</code> is the total number of terms in the DAG.</p>
<p>Paper link: <a href="https://dl.acm.org/doi/10.5555/3000001.3000272" class="external-link">https://dl.acm.org/doi/10.5555/3000001.3000272</a>.</p>
</div>


<div class="section">
<h3 id="ic-zhou-">IC_Zhou_2008<a class="anchor" aria-label="anchor" href="#ic-zhou-"></a></h3>


<p>It is a correction of <em>IC_Seco_2004</em> which considers the depth of a term in the DAG.
The information content is calculated as:</p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>IC <span class="ot">=</span> <span class="fl">0.5</span><span class="sc">*</span>IC_Seco <span class="sc">+</span> <span class="fl">0.5</span><span class="sc">*</span><span class="fu">log</span>(depth)<span class="sc">/</span><span class="fu">log</span>(max_depth)</span></code></pre><p></p></div>
<p>where <code>depth</code> is the depth of term <code>t</code> in the DAG, defined as the maximal distance from root. <code>max_depth</code> is the largest depth in the DAG.
So IC is composed with two parts: the numbers of offspring terms and positions in the DAG.</p>
<p>Paper link: <a href="https://doi.org/10.1109/FGCNS.2008.16" class="external-link">https://doi.org/10.1109/FGCNS.2008.16</a>.</p>
</div>


<div class="section">
<h3 id="ic-seddiqui-">IC_Seddiqui_2010<a class="anchor" aria-label="anchor" href="#ic-seddiqui-"></a></h3>


<p>It is also a correction to <em>IC_Seco_2004</em>, but considers number of relations connecting a term (i.e. number of parent terms and child terms).
The information content is defined as:</p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>(<span class="dv">1</span><span class="sc">-</span>sigma)<span class="sc">*</span>IC_Seco <span class="sc">+</span> sigma<span class="sc">*</span><span class="fu">log</span>((n_parents <span class="sc">+</span> n_children <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">/</span><span class="fu">log</span>((total_edges <span class="sc">+</span> <span class="dv">1</span>))</span></code></pre><p></p></div>
<p>where <code>n_parents</code> and <code>n_children</code> are the numbers of parents and children of term <code>t</code>. The tuning factor <code>sigma</code> is defined as</p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">=</span> <span class="fu">log</span>(total_edges<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span>(<span class="fu">log</span>(total_edges) <span class="sc">+</span> <span class="fu">log</span>(total_terms))</span></code></pre><p></p></div>
<p>where <code>total_edges</code> is the number of all relations (all parent-child relations)
and <code>total_terms</code> is the number of all terms in the DAG.</p>
<p>Paper link: <a href="https://dl.acm.org/doi/10.5555/1862330.1862343" class="external-link">https://dl.acm.org/doi/10.5555/1862330.1862343</a>.</p>
</div>


<div class="section">
<h3 id="ic-sanchez-">IC_Sanchez_2011<a class="anchor" aria-label="anchor" href="#ic-sanchez-"></a></h3>


<p>It measures average contribution of term <code>t</code> on leaf terms. First denote <code>zeta</code> as the number of leaf terms that
can be reached from term <code>t</code> (or <code>t</code>'s offspring that are leaves.). Since all <code>t</code>'s ancestors can also
reach <code>t</code>'s leaves, the contribution of <code>t</code> on leaf terms is scaled by <code>n_ancestors</code> which is the number of <code>t</code>'s ancestor terms.
The final information content is normalized by the total number of leaves in the DAG, which is the possible maximal value of <code>zeta</code>.
The complete definition of information content is:</p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>IC <span class="ot">=</span> <span class="sc">-</span><span class="fu">log</span>( (zeta<span class="sc">/</span>n_ancestor) <span class="sc">/</span> n_all_leaves)</span></code></pre><p></p></div>
<p>Paper link: <a href="https://doi.org/10.1016/j.knosys.2010.10.001" class="external-link">https://doi.org/10.1016/j.knosys.2010.10.001</a>.</p>
</div>


<div class="section">
<h3 id="ic-meng-">IC_Meng_2012<a class="anchor" aria-label="anchor" href="#ic-meng-"></a></h3>


<p>It has a complex form which takes account of the term depth and the downstream of the term.
The first factor is calculated as:</p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>f1 <span class="ot">=</span> <span class="fu">log</span>(depth)<span class="sc">/</span><span class="fu">long</span>(max_depth)</span></code></pre><p></p></div>
<p>The second factor is calculated as:</p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>f1 <span class="ot">=</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">log</span>(<span class="dv">1</span> <span class="sc">+</span> sum_{x <span class="ot">=</span><span class="er">&gt;</span> t<span class="st">'s offspring}(1/depth_x))/log(total_terms)</span></span></code></pre><p></p></div>
<p>In the equation, the summation goes over <code>t</code>'s offspring terms.</p>
<p>The final information content is the multiplication of <code>f1</code> and <code>f2</code>:</p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>IC <span class="ot">=</span> f1 <span class="sc">*</span> f2</span></code></pre><p></p></div>
<p>Paper link: <a href="http://article.nadiapub.com/IJGDC/vol5_no3/6.pdf" class="external-link">http://article.nadiapub.com/IJGDC/vol5_no3/6.pdf</a>.</p>
<p>There is one parameter <code>correct</code>. If it is set to <code>TRUE</code>, the first factor <code>f1</code> is calculated as:</p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>f1 <span class="ot">=</span> <span class="fu">log</span>(depth <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">/</span><span class="fu">long</span>(max_depth <span class="sc">+</span> <span class="dv">1</span>)</span></code></pre><p></p></div>
<p><code>correct</code> can be set as:</p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">term_IC</span>(dag, <span class="at">method =</span> <span class="st">"IC_Meng_2012"</span>, <span class="at">control =</span> <span class="fu">list</span>(<span class="at">correct =</span> <span class="cn">TRUE</span>))</span></code></pre><p></p></div>
</div>


<div class="section">
<h3 id="ic-wang-">IC_Wang_2007<a class="anchor" aria-label="anchor" href="#ic-wang-"></a></h3>


<p>Each relation is weighted by a value less than 1 based on the semantic relation, i.e. 0.8 for "is_a" and 0.6 for "part_of".
For a term <code>t</code> and one of its ancestor term <code>a</code>, it first calculates an "S-value" which corresponds to a path from <code>a</code> to <code>t</code> where
the accumulated multiplication of weights along the path reaches maximal:</p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">S</span>(a<span class="ot">-&gt;</span>t) <span class="ot">=</span> <span class="fu">max</span>(<span class="fu">prod</span>(w))</span></code></pre><p></p></div>
<p>Here <code>max</code> goes over all possible paths from <code>a</code> to <code>t</code>, and <code><a href="https://rdrr.io/r/base/prod.html" class="external-link">prod()</a></code> multiplies edge weights in a certain path.</p>
<p>The formula can be transformed as (we simply rewrite <code>S(a-&gt;t)</code> to <code>S</code>):</p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">/</span>S <span class="ot">=</span> <span class="fu">min</span>(<span class="fu">prod</span>(<span class="dv">1</span><span class="sc">/</span>w))</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">log</span>(<span class="dv">1</span><span class="sc">/</span>S) <span class="ot">=</span> <span class="fu">log</span>(<span class="fu">min</span>(<span class="fu">prod</span>(<span class="dv">1</span><span class="sc">/</span>w)))</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>         <span class="ot">=</span> <span class="fu">min</span>(<span class="fu">sum</span>(<span class="fu">log</span>(<span class="dv">1</span><span class="sc">/</span>w)))</span></code></pre><p></p></div>
<p>Since <code>w &lt; 1</code>, <code>log(1/w)</code> is positive. According to the equation, the path (<code>a-&gt;...-&gt;t</code>) is actually the shortest path from <code>a</code> to <code>t</code> by taking
<code>log(1/w)</code> as the weight, and <code>log(1/S)</code> is the weighted shortest distance.</p>
<p>If <code>S(a-&gt;t)</code> can be thought as the maximal semantic contribution from <code>a</code> to <code>t</code>, the information content is calculated
as the sum from all <code>t</code>'s ancestors (including <code>t</code> itself):</p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>IC <span class="ot">=</span> sum_{a <span class="ot">=</span><span class="er">&gt;</span> t<span class="st">'s ancestors + t}(S(a-&gt;t))</span></span></code></pre><p></p></div>
<p>Paper link: <a href="https://doi.org/10.1093/bioinformatics/btm087" class="external-link">https://doi.org/10.1093/bioinformatics/btm087</a>.</p>
<p>The contribution of different semantic relations can be set with the <code>contribution_factor</code> parameter. The value should be a named numeric
vector where names should cover the relations defined in <code>relations</code> set in <code><a href="create_ontology_DAG.html">create_ontology_DAG()</a></code>. For example, if there are two relations
"relation_a" and "relation_b" set in the DAG, the value for <code>contribution_factor</code> can be set as:</p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">term_IC</span>(dag, <span class="at">method =</span> <span class="st">"IC_Wang"</span>, </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">control =</span> <span class="fu">list</span>(<span class="at">contribution_factor =</span> <span class="fu">c</span>(<span class="st">"relation_a"</span> <span class="ot">=</span> <span class="fl">0.8</span>, <span class="st">"relation_b"</span> <span class="ot">=</span> <span class="fl">0.6</span>)))</span></code></pre><p></p></div>
</div>

    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">parents</span>  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"b"</span>, <span class="st">"c"</span>, <span class="st">"d"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">children</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"b"</span>, <span class="st">"c"</span>, <span class="st">"c"</span>, <span class="st">"d"</span>, <span class="st">"e"</span>, <span class="st">"f"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">annotation</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="st">"a"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"t1"</span>, <span class="st">"t2"</span>, <span class="st">"t3"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="st">"b"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"t3"</span>, <span class="st">"t4"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="st">"c"</span> <span class="op">=</span> <span class="st">"t5"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"d"</span> <span class="op">=</span> <span class="st">"t7"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"e"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"t4"</span>, <span class="st">"t5"</span>, <span class="st">"t6"</span>, <span class="st">"t7"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="st">"f"</span> <span class="op">=</span> <span class="st">"t8"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dag</span> <span class="op">=</span> <span class="fu"><a href="create_ontology_DAG.html">create_ontology_DAG</a></span><span class="op">(</span><span class="va">parents</span>, <span class="va">children</span>, annotation <span class="op">=</span> <span class="va">annotation</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">term_IC</span><span class="op">(</span><span class="va">dag</span>, <span class="st">"IC_annotation"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         a         b         c         d         e         f </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.0000000 0.2876821 0.6931472 1.3862944 0.6931472 2.0794415 </span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Zuguang Gu.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

