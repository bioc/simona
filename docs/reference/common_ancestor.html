<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Various types of common ancestors — MICA_term • simona</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Various types of common ancestors — MICA_term"><meta property="og:description" content="Various types of common ancestors"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">simona</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.1.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/v01_dag.html">ontology_DAG: a class for ontology data</a>
    </li>
    <li>
      <a href="../articles/v02_GO.html">Gene Ontology</a>
    </li>
    <li>
      <a href="../articles/v03_import.html">Import ontology files</a>
    </li>
    <li>
      <a href="../articles/v04_information_content.html">Information content</a>
    </li>
    <li>
      <a href="../articles/v05_term_similarity.html">Term similarity</a>
    </li>
    <li>
      <a href="../articles/v06_group_similarity.html">Similarity between two groups of terms</a>
    </li>
    <li>
      <a href="../articles/v07_dag_visualization.html">Visualize DAGs</a>
    </li>
    <li>
      <a href="../articles/v08_random.html">Random DAGs</a>
    </li>
    <li>
      <a href="../articles/v09_shiny.html">Shiny app</a>
    </li>
    <li>
      <a href="../articles/v10_enrichment.html">Functional enrichment</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/jokergoo/simona/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Various types of common ancestors</h1>
    <small class="dont-index">Source: <a href="https://github.com/jokergoo/simona/blob/HEAD/R/common_ancestor.R" class="external-link"><code>R/common_ancestor.R</code></a></small>
    <div class="hidden name"><code>common_ancestor.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Various types of common ancestors</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">MICA_term</span><span class="op">(</span></span>
<span>  <span class="va">dag</span>,</span>
<span>  <span class="va">terms</span>,</span>
<span>  <span class="va">IC_method</span>,</span>
<span>  in_labels <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  distance <span class="op">=</span> <span class="st">"longest"</span>,</span>
<span>  verbose <span class="op">=</span> <span class="va">simona_opt</span><span class="op">$</span><span class="va">verbose</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">MICA_IC</span><span class="op">(</span><span class="va">dag</span>, <span class="va">terms</span>, <span class="va">IC_method</span>, verbose <span class="op">=</span> <span class="va">simona_opt</span><span class="op">$</span><span class="va">verbose</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">LCA_term</span><span class="op">(</span></span>
<span>  <span class="va">dag</span>,</span>
<span>  <span class="va">terms</span>,</span>
<span>  in_labels <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  distance <span class="op">=</span> <span class="st">"longest"</span>,</span>
<span>  verbose <span class="op">=</span> <span class="va">simona_opt</span><span class="op">$</span><span class="va">verbose</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">LCA_depth</span><span class="op">(</span><span class="va">dag</span>, <span class="va">terms</span>, verbose <span class="op">=</span> <span class="va">simona_opt</span><span class="op">$</span><span class="va">verbose</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">NCA_term</span><span class="op">(</span><span class="va">dag</span>, <span class="va">terms</span>, in_labels <span class="op">=</span> <span class="cn">TRUE</span>, verbose <span class="op">=</span> <span class="va">simona_opt</span><span class="op">$</span><span class="va">verbose</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">max_ancestor_v</span><span class="op">(</span><span class="va">dag</span>, <span class="va">terms</span>, <span class="va">value</span>, verbose <span class="op">=</span> <span class="va">simona_opt</span><span class="op">$</span><span class="va">verbose</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">max_ancestor_id</span><span class="op">(</span></span>
<span>  <span class="va">dag</span>,</span>
<span>  <span class="va">terms</span>,</span>
<span>  <span class="va">value</span>,</span>
<span>  in_labels <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  distance <span class="op">=</span> <span class="st">"longest"</span>,</span>
<span>  verbose <span class="op">=</span> <span class="va">simona_opt</span><span class="op">$</span><span class="va">verbose</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">max_ancestor_path_sum</span><span class="op">(</span></span>
<span>  <span class="va">dag</span>,</span>
<span>  <span class="va">terms</span>,</span>
<span>  <span class="va">value</span>,</span>
<span>  <span class="va">add_v</span>,</span>
<span>  distance <span class="op">=</span> <span class="st">"longest"</span>,</span>
<span>  verbose <span class="op">=</span> <span class="va">simona_opt</span><span class="op">$</span><span class="va">verbose</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>dag</dt>
<dd><p>An <code>ontology_DAG</code> object.</p></dd>


<dt>terms</dt>
<dd><p>A vector of term names.</p></dd>


<dt>IC_method</dt>
<dd><p>An IC method. Valid values are in <code><a href="all_methods.html">all_term_IC_methods()</a></code>.</p></dd>


<dt>in_labels</dt>
<dd><p>Whether the terms are represented in their names or as integer indices?</p></dd>


<dt>distance</dt>
<dd><p>If there are multiple LCA or MICA of two terms, whether to take the one with
the longest distance of shortest distance to the two terms. Possible values are "longest" and "shortest".</p></dd>


<dt>verbose</dt>
<dd><p>Whether to print messages.</p></dd>


<dt>value</dt>
<dd><p>A numeric vector. The elements should corrrespond to terms in <code><a href="dag_all_terms.html">dag_all_terms()</a></code> (should have the same length as the number of terms in the DAG).</p></dd>


<dt>add_v</dt>
<dd><p>Values to be added along the path to the MICA or LCA. The same format as <code>value</code>.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<ul><li><p><code>MICA_term()</code> returns an integer or a character matrix of the MICA terms depending on the value of <code>in_labels</code>.</p></li>
<li><p><code>MICA_IC()</code> returns a numeric matrix of the IC of the MICA terms.</p></li>
<li><p><code>LCA_term()</code> returns an integer or a character matrix of the LCA term depending on the value of <code>in_labels</code>.</p></li>
<li><p><code>LCA_depth()</code> returns an integer matrix of the depth of the LCA terms.</p></li>
<li><p><code>NCA_term()</code> returns an integer or a character matrix of the NCA term depending on the value of <code>in_labels</code>. The shortest distance from NCA terms can be calculated by <code><a href="distance.html">shortest_distances_via_NCA()</a></code>.</p></li>
<li><p><code>max_ancestor_v()</code> returns a numeric matrix.</p></li>
<li><p><code>max_ancestor_id()</code> returns an integer or a character matrix.</p></li>
</ul></div>
    <div id="details">
    <h2>Details</h2>
    <p>There are the following three types of common ancestors:</p><ul><li><p>MICA (most informative common ancestor): The common ancestor with the highest IC value.</p></li>
<li><p>LCA (lowest common ancestor): The common ancestor with the largest depth (The depth of a term is the maximal distance from the root term). If there are multiple ancestors having
the same max depth, the ancestor with the smallest distance to the two terms is used.</p></li>
<li><p>NCA (nearest common ancestor): The common ancestor with the smallest distance to the two terms. If there are multiple
ancestors with the same smallest distance, the ancestor with the largest depth is used.</p></li>
</ul><p><code>max_ancestor_v()</code> and <code>max_ancestor_id()</code> are more general functions which return common ancestors with
the highest value in <code>value</code>.</p>
<p>Given a path connecting two terms and their MICA/LCA, <code>max_ancestor_path_sum()</code> calculates the sum of terms along the path. The values
to be added in specified in <code>add_v</code> argument.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">parents</span>  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"b"</span>, <span class="st">"c"</span>, <span class="st">"d"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">children</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"b"</span>, <span class="st">"c"</span>, <span class="st">"c"</span>, <span class="st">"d"</span>, <span class="st">"e"</span>, <span class="st">"f"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dag</span> <span class="op">=</span> <span class="fu"><a href="create_ontology_DAG.html">create_ontology_DAG</a></span><span class="op">(</span><span class="va">parents</span>, <span class="va">children</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">MICA_term</span><span class="op">(</span><span class="va">dag</span>, <span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span>, <span class="st">"IC_universal"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> IC_method: IC_universal</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> collecting all ancestors of input terms ...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> going through 0 / 6 ancestors ...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> going through 6 / 6 ancestors ... Done.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   a   b   c   d   e   f  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a "a" "a" "a" "a" "a" "a"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b "a" "b" "b" "b" "b" "b"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> c "a" "b" "c" "b" "c" "b"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> d "a" "b" "b" "d" "b" "d"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> e "a" "b" "c" "b" "e" "b"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f "a" "b" "b" "d" "b" "f"</span>
<span class="r-in"><span><span class="fu">MICA_IC</span><span class="op">(</span><span class="va">dag</span>, <span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span>, <span class="st">"IC_universal"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> IC_method: IC_universal</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> collecting all ancestors of input terms ...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> going through 0 / 6 ancestors ...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> going through 6 / 6 ancestors ... Done.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   a         b         c         d         e         f</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a 0 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b 0 0.6931472 0.6931472 0.6931472 0.6931472 0.6931472</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> c 0 0.6931472 2.0794415 0.6931472 2.0794415 0.6931472</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> d 0 0.6931472 0.6931472 1.3862944 0.6931472 1.3862944</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> e 0 0.6931472 2.0794415 0.6931472 2.0794415 0.6931472</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f 0 0.6931472 0.6931472 1.3862944 0.6931472 1.3862944</span>
<span class="r-in"><span><span class="fu">LCA_term</span><span class="op">(</span><span class="va">dag</span>, <span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> collecting all ancestors of input terms ...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> going through 0 / 6 ancestors ...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> going through 6 / 6 ancestors ... Done.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   a   b   c   d   e   f  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a "a" "a" "a" "a" "a" "a"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b "a" "b" "b" "b" "b" "b"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> c "a" "b" "c" "b" "c" "b"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> d "a" "b" "b" "d" "b" "d"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> e "a" "b" "c" "b" "e" "b"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f "a" "b" "b" "d" "b" "f"</span>
<span class="r-in"><span><span class="fu">LCA_depth</span><span class="op">(</span><span class="va">dag</span>, <span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> collecting all ancestors of input terms ...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> going through 0 / 6 ancestors ...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> going through 6 / 6 ancestors ... Done.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   a b c d e f</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a 0 0 0 0 0 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b 0 1 1 1 1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> c 0 1 2 1 2 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> d 0 1 1 2 1 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> e 0 1 2 1 3 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f 0 1 1 2 1 3</span>
<span class="r-in"><span><span class="fu">NCA_term</span><span class="op">(</span><span class="va">dag</span>, <span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> collecting all ancestors of input terms ...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> going through 0 / 6 ancestors ...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> going through 6 / 6 ancestors ... Done.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   a   b   c   d   e   f  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a "a" "a" "a" "a" "a" "a"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b "a" "b" "b" "b" "b" "b"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> c "a" "b" "c" "b" "c" "b"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> d "a" "b" "b" "d" "b" "d"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> e "a" "b" "c" "b" "e" "b"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f "a" "b" "b" "d" "b" "f"</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Zuguang Gu.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

